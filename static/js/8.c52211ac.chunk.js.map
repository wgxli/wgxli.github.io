{"version":3,"sources":["pages/Blog/posts/2020-08-20-prime-tangents/body.js","pages/Blog/posts/util.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js"],"names":["__webpack_exports__","react__WEBPACK_IMPORTED_MODULE_1___default","a","createElement","Fragment","String","raw","_templateObject","_templateObject2","_util_js__WEBPACK_IMPORTED_MODULE_2__","id","language","className","_templateObject3","start","href","__webpack_require__","d","ResponsiveImage","Footnotes","Footnote","Ref","Code","react__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_0___default","n","react_syntax_highlighter__WEBPACK_IMPORTED_MODULE_1__","react_syntax_highlighter_dist_esm_languages_hljs_javascript__WEBPACK_IMPORTED_MODULE_2__","react_syntax_highlighter_dist_esm_languages_hljs_python__WEBPACK_IMPORTED_MODULE_3__","react_syntax_highlighter_dist_esm_styles_hljs_a11y_dark__WEBPACK_IMPORTED_MODULE_4__","_ref","desktopSource","mobileSource","alt","src","_ref2","children","_ref3","concat","_ref4","_ref5","style","a11ydark","showLineNumbers","startingLineNumber","SyntaxHighlighter","registerLanguage","js","python","_taggedTemplateLiteral","strings","slice","Object","freeze","defineProperties","value"],"mappings":"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","file":"static/js/8.c52211ac.chunk.js","sourcesContent":["import React from 'react';\n\nimport {Footnotes, Footnote, Ref, Code} from '../util.js';\n\nexport default function() {\n    return <>\n        {String.raw`\\[p + \\epsilon = \\left(k + \\frac{1}{2}\\right) \\pi,\\]`}\n        <p>which rearranges to</p>\n        {String.raw`\\[\\pi = \\frac{2p}{2k + 1} + \\frac{2\\epsilon}{2k+1}.\\]`}\n        <p>Moreover, for small \\(\\epsilon\\), we have the excellent approximation\n        {' \\\\(\\\\tan{p} \\\\sim \\\\epsilon^{-1}\\\\)'}.\n        Requiring {' \\\\(\\\\tan{p} > p\\\\)'} then imposes the condition \\(p \\epsilon \\in [0, 1)\\), or</p>\n        \\[p \\cdot \\left[(2k + 1) \\, \\pi - 2p\\right] \\in [0, 2).\\]\n        <p>Summing up the above, we want rational approximations to \\(\\pi\\) that are a bit too small, but <i>exceedingly</i> close.<Ref id={1}/>\n        How do we go about looking for such approximations? The continued fraction expansion, of course!</p>\n        <Code language='python'>{`def continued_fraction_coefficients():\n    \"\"\"Read the continued fraction coefficients of pi from a file.\"\"\"\n    # Left as an exercise to the reader\n\ndef rational_approximations():\n    \"\"\"Generate the sequence of best rational approximants of pi.\"\"\"\n    # We use the isomorphism between SL_2(R) and the fractional linear transformations.\n    # We start with the function 1/x, and repeatedly pre-compose\n    # with 1/(a + x), where a is the continued fraction coefficient.\n    # We return the limit of the current rational function as x → ∞.\n    n0, n1 = 0, 1\n    d0, d1 = 1, 0\n    for a in continued_fraction_coefficients():\n        (n0, n1) = (n1, a * n1 + n0)\n        (d0, d1) = (d1, a * d1 + d0)\n        yield (n1, d1)\n`}</Code>\n        <p>For each rational approximation \\(n/d\\) with \\(n = 2p\\) even and \\(d = 2k+1\\) odd, we’d like to check if \\(p \\cdot (d \\pi - 2p) \\in [0, 2)\\). But since we’re going to be working with huge numbers, we want to avoid floating point math if possible.</p>\n        <p>One way to accomplish this is to replace the \\(\\pi\\) in this check with an even <i>better</i> rational approximation \\(n' / d'\\).\n        For this check to be accurate, we’d like \\(d' \\gg p \\cdot d\\).\n        The condition then becomes</p>\n        <p className='emphasis'>\n            {String.raw`\\[0 \\leq p \\cdot (dn' - 2pd') < 2d',\\]`}\n        </p>\n        <p>which only involves integer math. Summing up the above:</p>\n        <Code language='python' start={17}>{`gen1 = rational_approximations()\ngen2 = rational_approximations()\n\nfor n, d in gen1:\n    # We want n/d with n even, d odd.\n    if n % 2 != 0 or d % 2 == 0: continue\n    p = n // 2\n\n    # We'd like d' >> pd; I found that d' > 4pd works fine.\n    threshold = 4 * p * d\n    while True:\n        nn, dd = next(gen2)\n        if dd > threshold:\n            break\n\n    # Our integer-math-only check for an 'interesting' value of p.\n    if 0 <= p * (d*nn - 2*p*dd) < 2*dd:\n        # At this point, we should have tan(p) > p.\n        # All that remains is a primality check:\n        if is_probable_prime(p):\n            print(p)\n`}</Code>\n        <p>If you’re following along, you might want to add more logging just to see what the code is doing. All that remains is to define a reasonable probabilistic primality test <code>is_probable_prime</code>. Personally, I got the best performance by doing trial division on primes up to a million, then calling <a href='https://sourceforge.net/projects/openpfgw/'>PFGW</a> via <code>subprocess</code>. If you want to stay within Python, the <a href='https://pypi.org/project/gmpy2/'>gmpy2</a> library is also a reasonable option:</p>\n        <Code language='python'>{`from gmpy2 import is_strong_prp, is_prime\n\nPRIMES = [k for k in range(1, 1000000) if is_prime(k)]\ndef is_probable_prime(n):\n    if any(n % p == 0 for p in PRIMES):\n        return False\n    return is_strong_prp(n, 3)\n`}</Code>\n\n        <p>The verdict? In less than a second, we reproduce the 46-digit prime mentioned at the start of the blog post.\n        In two or three seconds, we find a 1017-digit prime solution (which Matt <a href='https://twitter.com/standupmaths/status/1296400194721001472'>mentioned</a>),\n        which begins and ends as</p>\n        \\[p = 230835870782\\dots 610326005069.\\]\n        <p>And after a few hours, we find the monstrous 35,085-digit prime</p>\n        \\[p = 409461998988\\dots 829370185991,\\]\n        <p>which, at the time of writing, I believe Matt (and, perhaps, everybody else in the world) is unaware of.</p>\n        <p>I think that's enough for today.</p>\n\n        <Footnotes>\n        <Footnote id={1}>More precisely, we want an approximation accurate to the order of denominator squared. The constants are a bit too small to apply <a href='https://en.wikipedia.org/wiki/Dirichlet%27s_approximation_theorem'>Dirichlet’s approximation theorem</a> directly, so we aren’t guaranteed infinitely many solutions (although I suspect there are).</Footnote>\n        </Footnotes>\n    </>;\n}\n","import React from 'react';\n\nimport {Light as SyntaxHighlighter} from 'react-syntax-highlighter';\nimport js from 'react-syntax-highlighter/dist/esm/languages/hljs/javascript';\nimport python from 'react-syntax-highlighter/dist/esm/languages/hljs/python';\nimport a11ydark from 'react-syntax-highlighter/dist/esm/styles/hljs/a11y-dark';\n\nimport './footnotes.css';\n\n\nSyntaxHighlighter.registerLanguage('javascript', js);\nSyntaxHighlighter.registerLanguage('python', python);\n\n\nfunction ResponsiveImage({desktopSource, mobileSource, alt}) {\n    return <>\n        <img src={desktopSource} className='desktop' alt={alt}/>\n        <img src={mobileSource} className='mobile' alt={alt}/>\n    </>;\n}\n\n\nfunction Footnotes({children}) {\n    return <section className='footnotes'>\n        <hr/>\n        <h2>Footnotes</h2>\n        <ol>\n            {children}\n        </ol>\n    </section>;\n}\n\nfunction Footnote({children, id}) {\n    return <li>\n        <span className='label'>[{id}]</span>\n        {children}\n        <a className='reference return' href={`#reference-${id}`}>↩</a>\n        <span className='anchor' id={`footnote-${id}`}/>\n    </li>;\n}\n\nfunction Ref({id}) {\n    return <a\n        className='reference'\n        href={`#footnote-${id}`}\n    >\n        <sup>[{id}]</sup>\n        <span className='anchor' id={`reference-${id}`}/>\n    </a>;\n}\n\nfunction Code({children, language, start}) {\n    return <SyntaxHighlighter\n        language={language}\n        style={a11ydark}\n        showLineNumbers\n        startingLineNumber={start || 1}\n    >\n        {children}\n    </SyntaxHighlighter>\n}\n\nexport {\n    ResponsiveImage,\n    Footnotes, Footnote, Ref,\n    Code\n};\n","export default function _taggedTemplateLiteral(strings, raw) {\n  if (!raw) {\n    raw = strings.slice(0);\n  }\n\n  return Object.freeze(Object.defineProperties(strings, {\n    raw: {\n      value: Object.freeze(raw)\n    }\n  }));\n}"],"sourceRoot":""}