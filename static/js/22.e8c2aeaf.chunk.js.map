{"version":3,"sources":["pages/Blog/posts/2021-05-05-erf-expansion/body.js"],"names":["__webpack_exports__","react__WEBPACK_IMPORTED_MODULE_1___default","a","createElement","Fragment","String","raw","_templateObject","_templateObject2","_templateObject3","_templateObject4","_templateObject5","_templateObject6","_templateObject7","_templateObject8","_templateObject9","href"],"mappings":"6pKAEeA,EAAA,mBACX,OAAOC,EAAAC,EAAAC,cAAAF,EAAAC,EAAAE,SAAA,KACHH,EAAAC,EAAAC,cAAA,gBAAQE,OAAOC,IAAfC,KAAA,wQACCF,OAAOC,IAFLE,KAWHP,EAAAC,EAAAC,cAAA,wHACCE,OAAOC,IAZLG,KAeHR,EAAAC,EAAAC,cAAA,uHACCE,OAAOC,IAhBLI,KAAA,oFAqBFL,OAAOC,IArBLK,KAyBHV,EAAAC,EAAAC,cAAA,mMACCE,OAAOC,IA1BLM,KAgCHX,EAAAC,EAAAC,cAAA,oEACCE,OAAOC,IAjCLO,KAqCHZ,EAAAC,EAAAC,cAAA,6JAAmJ,cAAnJ,iMACCE,OAAOC,IAtCLQ,KA2CHb,EAAAC,EAAAC,cAAA,yHACCE,OAAOC,IA5CLS,KAoDHd,EAAAC,EAAAC,cAAA,oDAA2CF,EAAAC,EAAAC,cAAA,KAAGa,KAAK,6BAAR,4BAA3C","file":"static/js/22.e8c2aeaf.chunk.js","sourcesContent":["import React from 'react';\n\nexport default function() {\n    return <>\n        <p>Let {String.raw`\\(\\omega \\defeq e^{i \\pi/4}\\)`}, and parameterize the complex plane via \\(z = r \\omega  + s \\, i \\omega\\). Consider the piecewise linear contour traveling from \\(0\\) to \\(r \\omega\\), and then from \\(r \\omega\\) to \\(r \\omega + s \\, i \\omega\\). Using this contour, we compute</p>\n        {String.raw`\\[\n        \\begin{aligned}\n            \\frac{\\sqrt{\\pi}}{2} \\, \\mathrm{erf}(z)\n            &= \\int_0^z e^{-x^2} \\dd{x} \\\\\n            &= \\int_0^r e^{-(t \\omega)^2} \\omega \\dd{t}\n            + \\int_0^s e^{-(r \\omega + t i \\omega)^2} i \\omega \\dd{t} \\\\\n            &= \\omega \\, [C(r) - i \\, S(r)] + i \\omega e^{-ir^2} \\int_0^s e^{2rt + it^2} \\dd{t},\n        \\end{aligned}\n        \\]`}\n        <p>where \\(S(x)\\) and \\(C(x)\\) are the Fresnel integrals. From Wikipedia, we have the asymptotic expansion</p>\n        {String.raw`\\[\n            C(x) - i \\, S(x) = \\frac{\\sqrt{\\pi}}{2} \\overline{\\omega} - [1 + \\O(x^{-4})] \\, \\frac{\\cos{x^2} - i \\sin{x^2}}{2x} \\, \\left[\\frac{1}{2x^2} - i\\right]\n        \\]`}\n        <p>for large positive \\(x\\). The second term is more annoying. For large \\(a > 0\\), consider the integral</p>\n        {String.raw`\\[\\begin{aligned}\n            I_a(x) &\\defeq e^{-ax} \\int_{-\\infty}^x e^{at} e^{it^2} \\dd{t} \\\\\n            &= a \\int_{-\\infty}^x \\int_x^\\infty e^{a \\, (t-s)} e^{it^2} \\dd{s} \\dd{t}.\n        \\end{aligned}\\]`}\n        Making the change of variables \\((u, v) \\defeq (a \\, (s-t), x-t)\\), we obtain\n        {String.raw`\\[\\begin{aligned}\n            I_a(x)\n            &= \\int_0^\\infty e^{-u} \\int_0^{u/a} e^{i \\, (x-v)^2} \\dd{v} \\dd{u}.\n        \\end{aligned}\\]`}\n        <p>The inner integral can be evaluated as a sum of four Fresnel integrals, and is therefore bounded by a constant. Then for large \\(a\\), it is fruitful to perform the Taylor expansion</p>\n        {String.raw`\\[\\begin{aligned}\n            \\int_0^{u/a} e^{i \\, (x-v)^2} \\dd{v}\n            &= e^{ix^2} \\int_0^{u/a} e^{-2ixv + iv^2} \\dd{v} \\\\\n            &= e^{ix^2} \\int_0^{u/a} [1 - 2ixv + iv^2 - 2x^2v^2 + \\O(v^3)] \\dd{v} \\\\\n            &= e^{ix^2} \\, \\left[\\frac{u}{a} - \\frac{ixu^2}{a^2} + \\frac{(i - 2x^2) \\, u^3}{3a^3} + \\O(a^{-4})\\right].\n        \\end{aligned}\\]`}\n        <p>Evaluating the standard gamma integrals, we thus obtain</p>\n        {String.raw`\\[\\begin{aligned}\n            I_a(x)\n            &= e^{-ix^2} \\left[a^{-1} - 2ixa^{-2} + (2i - 4x^2) \\, a^{-3} + \\O(a^{-4})\\right].\n        \\end{aligned}\\]`}\n        <p>We were a bit handwavy with the justification for Fubini. Indeed, the above expansion works well for \\(x > 0\\), but fails catastrophically for {'\\\\(x < 0\\\\)'}. From the definition of \\(I_a(x)\\), it is evident that small errors in the integral are exponentially amplified for negative \\(x\\). Empirically, however, we find that the approximation</p>\n        {String.raw`\\[\\begin{aligned}\n            \\int_0^x e^{at} e^{it^2} \\dd{t}\n            &= e^{ax} \\, I_a(x) - I_a(0) \\\\\n            &\\approx e^{ax+ix^2} \\left[a^{-1} - 2ixa^{-2} + (2i - 4x^2) \\, a^{-3}\\right] - a^{-1} - 2i a^{-3}\n        \\end{aligned}\\]`}\n        <p>works very well, and could probably be derived rigorously with more effort. Combining all the above, we have</p>\n        {String.raw`\\[\n        \\begin{aligned}\n            \\mathrm{erf}(z)\n            &= \\frac{2}{\\sqrt{\\pi}} \\omega \\, [C(r) - i \\, S(r)] + \\frac{2}{\\sqrt{\\pi}} i \\omega e^{-ir^2} [e^{2rs} I_{2r}(s) - I_{2r}(0)] \\\\\n            &\\approx 1 - \\frac{2}{\\sqrt{\\pi}} \\frac{\\cos{r^2} - i \\sin{r^2}}{2r} \\left[\\frac{1}{2r} - i\\right] \\\\\n            &+ \\frac{i \\omega}{2 \\sqrt{\\pi}} e^{-ir^2} \\left[e^{2rs+is^2} \\left(2r^{-1} - 2isr^{-2} + (i + 2s^2) \\, r^{-3} \\right) - 2r^{-1} - i r^{-3}\\right],\n        \\end{aligned}\n        \\]`}\n        <p>which is the implementation I use in my <a href='/complex-function-plotter'>complex function plotter</a>. (I go up to fourth order in the app.)</p>\n    </>;\n}\n"],"sourceRoot":""}