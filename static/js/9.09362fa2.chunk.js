(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{542:function(e,t,n){},546:function(e,t,n){"use strict";n.r(t);var a=n(35),r=n(11),i=n(12),o=n(14),l=n(13),u=n(15),s=n(0),c=n.n(s),f=n(545),d=n(547),m=n(96),v="\nprecision highp float;\n\nuniform sampler2D u_texture;\nuniform vec2 u_resolution;\n\nuniform float u_pass;\nuniform float u_random_seed;\n\nconst int N_MAX = 100;\nuniform float u_N;\n\nvarying vec2 v_texCoord;\n\n\nvec4 get_pixel(float dx, float dy) {\n    vec2 pos = v_texCoord * u_resolution + vec2(dx, dy);\n    pos.x = mod(pos.x, u_resolution.x);\n    pos.y = mod(pos.y, u_resolution.y);\n    return texture2D(\n        u_texture,\n        pos / u_resolution\n    );\n}\n\nfloat get_value(float dx, float dy) {\n    vec4 pixel = get_pixel(dx, dy) * 255.0;\n    // The 255.0 on pixel.w is intentional\n    return (pixel.x + (pixel.y + (pixel.z + pixel.w/255.0)/256.0)/256.0)/256.0;\n}\n\nvec4 encode(float value) {\n    vec4 encoded = vec4(0.0, 0.0, 0.0, 0.0);\n    for (int i = 0; i < 4; i++) {\n        value *= 256.0;\n        float pixel = floor(value);\n        value -= pixel;\n        encoded[i] = pixel/255.0;\n    }\n    // To account for rounding bias\n    encoded[3] += value/255.0;\n    return encoded;\n}\n\nfloat rand(vec2 co) {\n    return fract(sin(dot(co.xy, vec2(12.9898,78.233))) * 43758.5453);\n}\n\nvoid main() {\n    if (u_pass > 0.5) {\n        // Display texture to canvas\n        gl_FragColor = vec4(get_pixel(0.0, 0.0).xxx, 1.0);\n    } else {\n        // Apply kernel\n        float value = 0.0;\n        for (int i = 0; i < N_MAX; i++) {\n            float i_float = float(i);\n            if (i_float < u_N - 0.5) {\n                float x = rand(vec2(u_random_seed, i_float)) * u_resolution.x;\n                float y = rand(vec2(u_random_seed + 1.0, i_float)) * u_resolution.y;\n                value += get_value(x, y);\n            }\n        }\n        value /= u_N;\n\n        gl_FragColor = encode(value);\n    }\n}\n",h="\nattribute vec2 a_position;\n\nvarying vec2 v_texCoord;\n\nvoid main() {\n    v_texCoord = (a_position + 1.0) / 2.0;\n    gl_Position = vec4(a_position, 0, 1);\n}\n",E={canvas:null,gl:null,width:0,height:0,current:null,next:null,program:null,framebuffer:null,uniforms:{},state:{}};function p(e,t){var n=E.gl,a=n.createShader(e);if(n.shaderSource(a,t),n.compileShader(a),n.getShaderParameter(a,n.COMPILE_STATUS))return a;console.error(n.getShaderInfoLog(a)),n.deleteShader(a)}function _(e){var t=E.gl,n=E.width,a=E.height,r=t.createTexture();return t.bindTexture(t.TEXTURE_2D,r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n,a,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(e)),r}function x(e,t){var n=E.gl,a=E.state,r=E.uniforms;a[e]=t,n.uniform1f(r[e],t)}function g(e){E.canvas=e,E.gl=e.getContext("webgl"),function(){var e=E.gl,t=p(e.VERTEX_SHADER,h),n=p(e.FRAGMENT_SHADER,v),a=e.createProgram();E.program=a,e.attachShader(a,t),e.attachShader(a,n),e.linkProgram(a),e.getProgramParameter(a,e.LINK_STATUS)&&e.useProgram(a),console.error(e.getProgramInfoLog(a)),e.deleteProgram(a)}(),function(){var e=E.gl,t=E.program,n=e.getAttribLocation(t,"a_position"),a=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,a),e.enableVertexAttribArray(n),e.vertexAttribPointer(n,2,e.FLOAT,!1,0,0),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),e.STATIC_DRAW)}(),E.framebuffer=E.gl.createFramebuffer(),function(){for(var e=E.gl,t=E.state,n=E.uniforms,r=E.program,i=Object.entries(t),o=0;o<i.length;o++){var l=i[o],u=Object(a.a)(l,2),s=u[0],c=u[1];n[s]=e.getUniformLocation(r,"u_"+s),e.uniform1f(n[s],c)}n.resolution=e.getUniformLocation(r,"u_resolution")}()}function T(){var e=E.width,t=window.devicePixelRatio,n=window.innerWidth>600?500*t:300*t;n!==e&&(!function(e,t){var n=E.canvas,a=E.gl,r=E.uniforms;E.width=e,E.height=t,n.setAttribute("width",e),n.setAttribute("height",t),a.viewport(0,0,e,t),a.uniform2f(r.resolution,e,t)}(n,n),R())}function b(e){e=Math.max(Math.min(e,1),0);for(var t=[];t.length<4;){e*=256;var n=Math.min(Math.floor(e),255);e-=n,t.push(n)}return t}function R(){var e=function(){for(var e=E.width,t=E.height,n=[],a=0;a<e*t;a++){var r=Math.floor(a/e),i=a-r*e,o=function(n,a){return Math.hypot(n/e-.5,a/t-.5)<.5?1:0},l=.25*(o((i+=.5)-.25,(r+=.5)-.25)+o(i-.25,r+.25)+o(i+.25,r-.25)+o(i+.25,r+.25));n.push.apply(n,Object(m.a)(b(l)))}return n}();E.current=_(e),E.next=_(e),x("random_seed",Math.random()),A()}function A(){var e=E.gl,t=E.current;x("pass",1),e.bindTexture(e.TEXTURE_2D,t),e.bindFramebuffer(e.FRAMEBUFFER,null),e.drawArrays(e.TRIANGLES,0,6)}n(542);var w=function(e){function t(){var e,n;Object(r.a)(this,t);for(var a=arguments.length,i=new Array(a),u=0;u<a;u++)i[u]=arguments[u];return(n=Object(o.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(i)))).state={estimate:0,width:0,height:0,N:0,quality:0},n}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e;e=this.canvas.current,E.state={pass:null,N:null,random_seed:null},g(e),window.addEventListener("resize",T),T(),x("N",50),this.updateValue(),this.updateMetadata(),this.resizeListener=this.updateMetadata.bind(this),window.addEventListener("resize",this.resizeListener)}},{key:"updateValue",value:function(){var e=function(){var e=E.gl,t=E.framebuffer,n=new Uint8Array(4);return e.bindFramebuffer(e.FRAMEBUFFER,t),e.readPixels(0,0,1,1,e.RGBA,e.UNSIGNED_BYTE,n),4*function(e){for(var t=0,n=3;n>=0;n--)t+=e[n],t/=256;return t}(n)}();this.setState({estimate:e}),window.katex.render("\\pi \\approx ".concat(e.toFixed(5),"..."),this.estimate.current)}},{key:"updateMetadata",value:function(){var e=function(){var e=E.width,t=E.height,n=E.state.N,a=Math.sqrt(n/Math.log(e*t));return[e,t,n,Math.max(a,1)]}(),t=Object(a.a)(e,4),n=t[0],r=t[1],i=t[2],o=t[3];this.setState({width:n,height:r,N:i,quality:o}),window.katex.render("N = ".concat(i),this.sparsityLabel.current)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resizeListener),function(){var e=E.gl;window.removeEventListener("resize",T),E.canvas=null,E.gl=null,E.program=null,E.width=0,E.height=0,e.deleteTexture(E.current),e.deleteTexture(E.next),e.deleteFramebuffer(E.framebuffer),E.current=null,E.next=null,E.framebuffer=null}()}},{key:"render",value:function(){var e=this,t=this.state,n=t.width,a=t.height,r=t.N,i=t.quality;return this.canvas=Object(s.createRef)(),this.estimate=Object(s.createRef)(),this.sparsityLabel=Object(s.createRef)(),c.a.createElement("div",{className:"pi-computer"},c.a.createElement("p",{className:"estimate",ref:this.estimate}),c.a.createElement("div",{className:"controls"},c.a.createElement(f.a,{onClick:function(){!function(){var e=E.gl,t=E.framebuffer,n=E.current;x("pass",0),e.bindTexture(e.TEXTURE_2D,n),e.bindFramebuffer(e.FRAMEBUFFER,t),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,E.next,0),e.drawArrays(e.TRIANGLES,0,6),e.bindFramebuffer(e.FRAMEBUFFER,null),E.current=E.next,E.next=n,A()}(),e.updateValue()},variant:"contained",color:"primary"},"Step"),c.a.createElement(f.a,{onClick:R,variant:"outlined"},"Reset")),c.a.createElement("canvas",{ref:this.canvas},"Please enable Javascript and WebGL to use the demo."),c.a.createElement("div",{className:"kernel-slider"},c.a.createElement("p",{className:"header"},"Kernel Sparsity"),c.a.createElement("p",{className:"label",ref:this.sparsityLabel}),c.a.createElement(d.a,{min:3,max:100,value:r,onChange:function(t,n){x("N",n),e.updateMetadata()}})),c.a.createElement("p",{className:"size"},"Texture Size: ",n," \xd7 ",a,c.a.createElement("br",null),"Estimated Quality: Q(K) = ",i.toFixed(3),c.a.createElement("br",null)))}}]),t}(s.PureComponent);t.default=w}}]);
//# sourceMappingURL=9.09362fa2.chunk.js.map