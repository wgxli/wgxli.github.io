<!DOCTYPE html><html data-scroll="0" lang="en"><head><meta charset="utf-8"><meta content="width=device-width,initial-scale=1,shrink-to-fit=no" name="viewport"><meta content="#121c21" name="theme-color" id="meta-theme-color"><link href="/manifest.json" rel="manifest"><link href="/favicon.ico" rel="shortcut icon"><title>Samuel J. Li — Optimal Kernel-Based Averaging</title><meta content="Samuel J. Li — Math and physics specialist at the University of Toronto." name="description"><meta content="samuel li,university,toronto,projects,programmer,wgxli,math,physics,blog" name="keywords"><script src="https://www.google-analytics.com/analytics.js" async type="text/javascript"></script><script type="application/ld+json">{"@context": "http://schema.org","@type": "Person","honorificPrefix": "Mr.","givenName": "Samuel","familyName": "Li","gender": "male","nationality": "Canada","affiliation": "University of Toronto","url": "https://samuelj.li/","sameAs": ["https://www.facebook.com/samuel.jli","https://www.linkedin.com/in/samuelj-li","https://github.com/wgxli"]}</script><script src="https://www.googletagmanager.com/gtag/js?id=UA-123422297-1" defer></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-123422297-1")</script><link href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" rel="stylesheet" crossorigin="anonymous" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X"><script src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" defer crossorigin="anonymous" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" defer crossorigin="anonymous" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa"></script><link href="/static/css/main.ce0eb764.chunk.css" rel="stylesheet"><link href="https://cdn.jsdelivr.net" rel="preconnect"><link href="https://www.googletagmanager.com" rel="preconnect"><link href="https://fonts.googleapis.com" rel="preconnect"><style data-styled-jsx="" type="text/css">.container.jsx-959105480{transform-origin:right top;transform:scale(.25);position:absolute;top:0;right:0;z-index:1000;display:none}@media print{.container.jsx-959105480{display:block}}</style><link href="/static/css/6.dbcb50aa.chunk.css" rel="stylesheet" type="text/css"><script src="/static/js/6.2b2af048.chunk.js" charset="utf-8"></script><link href="/static/css/4.dbcb50aa.chunk.css" rel="stylesheet" type="text/css"><script src="/static/js/4.41c4b2a9.chunk.js" charset="utf-8"></script><link href="/static/css/3.8e1d9cdb.chunk.css" rel="stylesheet" type="text/css"><script src="/static/js/3.dc6fab74.chunk.js" charset="utf-8"></script><link href="https://fonts.gstatic.com" rel="preconnect"><script src="/static/js/8.a519e305.chunk.js" charset="utf-8"></script><link href="/static/css/7.d81dec3b.chunk.css" rel="stylesheet" type="text/css"><script src="/static/js/7.14c09ab8.chunk.js" charset="utf-8"></script><link href="https://www.google-analytics.com" rel="preconnect"><style data-jss="" data-meta="MuiTouchRipple">.MuiTouchRipple-root{top:0;left:0;right:0;bottom:0;z-index:0;overflow:hidden;position:absolute;border-radius:inherit;pointer-events:none}.MuiTouchRipple-ripple{opacity:0;position:absolute}.MuiTouchRipple-rippleVisible{opacity:.3;animation:MuiTouchRipple-keyframes-enter 550ms cubic-bezier(.4,0,.2,1);transform:scale(1)}.MuiTouchRipple-ripplePulsate{animation-duration:.2s}.MuiTouchRipple-child{width:100%;height:100%;display:block;opacity:1;border-radius:50%;background-color:currentColor}.MuiTouchRipple-childLeaving{opacity:0;animation:MuiTouchRipple-keyframes-exit 550ms cubic-bezier(.4,0,.2,1)}.MuiTouchRipple-childPulsate{top:0;left:0;position:absolute;animation:MuiTouchRipple-keyframes-pulsate 2.5s cubic-bezier(.4,0,.2,1) .2s infinite}@-webkit-keyframes MuiTouchRipple-keyframes-enter{0%{opacity:.1;transform:scale(0)}100%{opacity:.3;transform:scale(1)}}@-webkit-keyframes MuiTouchRipple-keyframes-exit{0%{opacity:1}100%{opacity:0}}@-webkit-keyframes MuiTouchRipple-keyframes-pulsate{0%{transform:scale(1)}50%{transform:scale(.92)}100%{transform:scale(1)}}</style><style data-jss="" data-meta="MuiButtonBase">.MuiButtonBase-root{color:inherit;border:0;cursor:pointer;margin:0;display:inline-flex;outline:0;padding:0;position:relative;align-items:center;user-select:none;border-radius:0;vertical-align:middle;-moz-appearance:none;justify-content:center;text-decoration:none;background-color:transparent;-webkit-appearance:none;-webkit-tap-highlight-color:transparent}.MuiButtonBase-root::-moz-focus-inner{border-style:none}.MuiButtonBase-root.Mui-disabled{cursor:default;pointer-events:none}@media print{.MuiButtonBase-root{-webkit-print-color-adjust:exact}}</style><style data-jss="" data-meta="MuiButton">.MuiButton-root{color:rgba(0,0,0,.87);padding:6px 16px;font-size:.875rem;min-width:64px;box-sizing:border-box;transition:background-color 250ms cubic-bezier(.4,0,.2,1) 0s,box-shadow 250ms cubic-bezier(.4,0,.2,1) 0s,border 250ms cubic-bezier(.4,0,.2,1) 0s;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:500;line-height:1.75;border-radius:4px;letter-spacing:.02857em;text-transform:uppercase}.MuiButton-root:hover{text-decoration:none;background-color:rgba(0,0,0,.04)}.MuiButton-root.Mui-disabled{color:rgba(0,0,0,.26)}@media (hover:none){.MuiButton-root:hover{background-color:transparent}}.MuiButton-root:hover.Mui-disabled{background-color:transparent}.MuiButton-label{width:100%;display:inherit;align-items:inherit;justify-content:inherit}.MuiButton-text{padding:6px 8px}.MuiButton-textPrimary{color:#2196f3}.MuiButton-textPrimary:hover{background-color:rgba(33,150,243,.04)}@media (hover:none){.MuiButton-textPrimary:hover{background-color:transparent}}.MuiButton-textSecondary{color:#2979ff}.MuiButton-textSecondary:hover{background-color:rgba(41,121,255,.04)}@media (hover:none){.MuiButton-textSecondary:hover{background-color:transparent}}.MuiButton-outlined{border:1px solid rgba(0,0,0,.23);padding:5px 15px}.MuiButton-outlined.Mui-disabled{border:1px solid rgba(0,0,0,.12)}.MuiButton-outlinedPrimary{color:#2196f3;border:1px solid rgba(33,150,243,.5)}.MuiButton-outlinedPrimary:hover{border:1px solid #2196f3;background-color:rgba(33,150,243,.04)}@media (hover:none){.MuiButton-outlinedPrimary:hover{background-color:transparent}}.MuiButton-outlinedSecondary{color:#2979ff;border:1px solid rgba(41,121,255,.5)}.MuiButton-outlinedSecondary:hover{border:1px solid #2979ff;background-color:rgba(41,121,255,.04)}.MuiButton-outlinedSecondary.Mui-disabled{border:1px solid rgba(0,0,0,.26)}@media (hover:none){.MuiButton-outlinedSecondary:hover{background-color:transparent}}.MuiButton-contained{color:rgba(0,0,0,.87);box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);background-color:#e0e0e0}.MuiButton-contained:hover{box-shadow:0 2px 4px -1px rgba(0,0,0,.2),0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12);background-color:#d5d5d5}.MuiButton-contained.Mui-focusVisible{box-shadow:0 3px 5px -1px rgba(0,0,0,.2),0 6px 10px 0 rgba(0,0,0,.14),0 1px 18px 0 rgba(0,0,0,.12)}.MuiButton-contained:active{box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.MuiButton-contained.Mui-disabled{color:rgba(0,0,0,.26);box-shadow:none;background-color:rgba(0,0,0,.12)}@media (hover:none){.MuiButton-contained:hover{box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);background-color:#e0e0e0}}.MuiButton-contained:hover.Mui-disabled{background-color:rgba(0,0,0,.12)}.MuiButton-containedPrimary{color:#fff;background-color:#2196f3}.MuiButton-containedPrimary:hover{background-color:#1976d2}@media (hover:none){.MuiButton-containedPrimary:hover{background-color:#2196f3}}.MuiButton-containedSecondary{color:#fff;background-color:#2979ff}.MuiButton-containedSecondary:hover{background-color:#2962ff}@media (hover:none){.MuiButton-containedSecondary:hover{background-color:#2979ff}}.MuiButton-disableElevation{box-shadow:none}.MuiButton-disableElevation:hover{box-shadow:none}.MuiButton-disableElevation.Mui-focusVisible{box-shadow:none}.MuiButton-disableElevation:active{box-shadow:none}.MuiButton-disableElevation.Mui-disabled{box-shadow:none}.MuiButton-colorInherit{color:inherit;border-color:currentColor}.MuiButton-textSizeSmall{padding:4px 5px;font-size:.8125rem}.MuiButton-textSizeLarge{padding:8px 11px;font-size:.9375rem}.MuiButton-outlinedSizeSmall{padding:3px 9px;font-size:.8125rem}.MuiButton-outlinedSizeLarge{padding:7px 21px;font-size:.9375rem}.MuiButton-containedSizeSmall{padding:4px 10px;font-size:.8125rem}.MuiButton-containedSizeLarge{padding:8px 22px;font-size:.9375rem}.MuiButton-fullWidth{width:100%}.MuiButton-startIcon{display:inherit;margin-left:-4px;margin-right:8px}.MuiButton-startIcon.MuiButton-iconSizeSmall{margin-left:-2px}.MuiButton-endIcon{display:inherit;margin-left:8px;margin-right:-4px}.MuiButton-endIcon.MuiButton-iconSizeSmall{margin-right:-2px}.MuiButton-iconSizeSmall>:first-child{font-size:18px}.MuiButton-iconSizeMedium>:first-child{font-size:20px}.MuiButton-iconSizeLarge>:first-child{font-size:22px}</style><style data-jss="" data-meta="PrivateValueLabel">.jss1.jss2 .jss3{transform:scale(1) translateY(-10px)}.jss3{top:-34px;z-index:1;position:absolute;font-size:.75rem;transform:scale(0);transition:transform 150ms cubic-bezier(.4,0,.2,1) 0s;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.2;letter-spacing:.01071em;transform-origin:bottom center}.jss4{width:32px;height:32px;display:flex;transform:rotate(-45deg);align-items:center;border-radius:50% 50% 50% 0;justify-content:center;background-color:currentColor}.jss5{color:#fff;transform:rotate(45deg)}</style><style data-jss="" data-meta="MuiSlider">.MuiSlider-root{color:#2196f3;width:100%;cursor:pointer;height:2px;display:inline-block;padding:13px 0;position:relative;box-sizing:content-box;touch-action:none;-webkit-tap-highlight-color:transparent}.MuiSlider-root.Mui-disabled{color:#bdbdbd;cursor:default;pointer-events:none}.MuiSlider-root.MuiSlider-vertical{width:2px;height:100%;padding:0 13px}@media (pointer:coarse){.MuiSlider-root{padding:20px 0}.MuiSlider-root.MuiSlider-vertical{padding:0 20px}}@media print{.MuiSlider-root{-webkit-print-color-adjust:exact}}.MuiSlider-colorSecondary{color:#2979ff}.MuiSlider-marked{margin-bottom:20px}.MuiSlider-marked.MuiSlider-vertical{margin-right:20px;margin-bottom:auto}.MuiSlider-rail{width:100%;height:2px;display:block;opacity:.38;position:absolute;border-radius:1px;background-color:currentColor}.MuiSlider-vertical .MuiSlider-rail{width:2px;height:100%}.MuiSlider-track{height:2px;display:block;position:absolute;border-radius:1px;background-color:currentColor}.MuiSlider-vertical .MuiSlider-track{width:2px}.MuiSlider-trackFalse .MuiSlider-track{display:none}.MuiSlider-trackInverted .MuiSlider-track{background-color:#aad7fa}.MuiSlider-trackInverted .MuiSlider-rail{opacity:1}.MuiSlider-thumb{width:12px;height:12px;display:flex;outline:0;position:absolute;box-sizing:border-box;margin-top:-5px;transition:box-shadow 150ms cubic-bezier(.4,0,.2,1) 0s;align-items:center;margin-left:-6px;border-radius:50%;justify-content:center;background-color:currentColor}.MuiSlider-thumb::after{top:-15px;left:-15px;right:-15px;bottom:-15px;content:"";position:absolute;border-radius:50%}.MuiSlider-thumb.Mui-focusVisible,.MuiSlider-thumb:hover{box-shadow:0 0 0 8px rgba(33,150,243,.16)}.MuiSlider-thumb.MuiSlider-active{box-shadow:0 0 0 14px rgba(33,150,243,.16)}.MuiSlider-thumb.Mui-disabled{width:8px;height:8px;margin-top:-3px;margin-left:-4px}.MuiSlider-vertical .MuiSlider-thumb{margin-left:-5px;margin-bottom:-6px}.MuiSlider-vertical .MuiSlider-thumb.Mui-disabled{margin-left:-3px;margin-bottom:-4px}.MuiSlider-thumb.Mui-disabled:hover{box-shadow:none}@media (hover:none){.MuiSlider-thumb.Mui-focusVisible,.MuiSlider-thumb:hover{box-shadow:none}}.MuiSlider-thumbColorSecondary.Mui-focusVisible,.MuiSlider-thumbColorSecondary:hover{box-shadow:0 0 0 8px rgba(41,121,255,.16)}.MuiSlider-thumbColorSecondary.MuiSlider-active{box-shadow:0 0 0 14px rgba(41,121,255,.16)}.MuiSlider-valueLabel{left:calc(-50% - 4px)}.MuiSlider-mark{width:2px;height:2px;position:absolute;border-radius:1px;background-color:currentColor}.MuiSlider-markActive{opacity:.8;background-color:#fff}.MuiSlider-markLabel{top:26px;color:rgba(0,0,0,.54);position:absolute;font-size:.875rem;transform:translateX(-50%);font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.43;white-space:nowrap;letter-spacing:.01071em}.MuiSlider-vertical .MuiSlider-markLabel{top:auto;left:26px;transform:translateY(50%)}@media (pointer:coarse){.MuiSlider-markLabel{top:40px}.MuiSlider-vertical .MuiSlider-markLabel{left:31px}}.MuiSlider-markLabelActive{color:rgba(0,0,0,.87)}</style></head><body><div id="root"><header id="navigation-bar"><div id="main-bar"><div id="main-logo-container"><a href="/" class="active" aria-current="page" id="main-logo">Samuel J. Li</a></div><nav class="desktop navigation-tabs"><a href="/projects/" class="nav-tab">Projects</a><a href="/blog/" class="nav-tab selected" aria-current="page">Blog</a><a href="/about/" class="nav-tab">About</a></nav><div id="social-buttons"><a href="https://github.com/wgxli"><img src="/static/media/github.62367fef.svg" alt="github social media icon" class="social-icon"></a><a href="https://www.linkedin.com/in/samuelj-li"><img src="/static/media/linkedin.02b94020.svg" alt="linkedin social media icon" class="social-icon"></a></div></div><nav class="mobile navigation-tabs"><a href="/projects/" class="nav-tab">Projects</a><a href="/blog/" class="nav-tab selected" aria-current="page">Blog</a><a href="/about/" class="nav-tab">About</a></nav><div class="jsx-959105480 container"><canvas height="300" width="300" style="height:300px;width:300px"></canvas></div></header><div id="page-container"><div id="page-top"></div><div class="banner-container thin"><img src="/images/banner/blog-1024.jpg" alt="blog banner background" class="banner-background" srcset="/images/banner/blog-256.jpg 256w, /images/banner/blog-512.jpg 512w, /images/banner/blog-1024.jpg 1024w, /images/banner/blog-2048.jpg 2048w, /images/banner/blog-4096.jpg 4096w"><div class="banner-overlay"><span class="banner-text"><h1>Optimal Kernel-Based Averaging</h1></span><a href="#banner-content-anchor" class="down-arrow"><img src="/static/media/down-arrow.b63a6dc0.svg"></a></div><div id="banner-content-anchor"></div></div><div class="blog" id="content-container"><div id="blog-content"><p class="aux-info"><span class="date">Published August 1, 2020</span>｜<span class="read-time">9 minute read</span></p><p>How do you average (or sum) a lot of numbers, quickly?</p><p>More precisely, how do you do this on a webpage, preferably in real-time, when your values are stored as pixels in a large image? In general-purpose applications, we have access to the massive parallelization capabilities of GPUs with CUDA or OpenCL — but on the web, we’re stuck with WebGL and fragment shaders.</p><p>One possibility is to write a fragment shader that repeatedly downscales the image by a factor of 2, where each output pixel is the average of the four pixels in its preimage. Assuming each render takes constant time due to GPU parallelization,<a href="#footnote-1" class="reference"><sup>[1]</sup><span class="anchor" id="reference-1"></span></a> this technique can average an <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.222222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.222222em"></span></span><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">n</span></span></span></span></span> texture in <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo><mi>log</mi><mo>⁡</mo></mo><mn>2</mn></msub><mi>n</mi></mrow><annotation encoding="application/x-tex">\log_2{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.93858em;vertical-align:-.24414em"></span><span class="mop"><span class="mop">lo<span style="margin-right:.01389em">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.206968em"><span class="" style="top:-2.45586em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.24414em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right:.166667em"></span><span class="mord"><span class="mord mathnormal">n</span></span></span></span></span></span> time.</p><div class="image-sequence-container"><span class="arrow desktop" style="display:none">→</span><span class="arrow mobile" style="display:none">↓</span><img src="/static/media/tux.2710825d.png" alt="Downscaled 0 times" height="150" width="150"><span class="arrow desktop" style="display:inline-block">→</span><span class="arrow mobile" style="display:inline-block">↓</span><img src="/static/media/tux.2710825d.png" alt="Downscaled 1 times" height="75" width="75"><span class="arrow desktop" style="display:inline-block">→</span><span class="arrow mobile" style="display:inline-block">↓</span><img src="/static/media/tux.2710825d.png" alt="Downscaled 2 times" height="38" width="38"><span class="arrow desktop" style="display:inline-block">→</span><img src="/static/media/tux.2710825d.png" alt="Downscaled 3 times" height="19" width="19" class="desktop"><span class="arrow desktop" style="display:inline-block">→</span><img src="/static/media/tux.2710825d.png" alt="Downscaled 4 times" height="9" width="9" class="desktop"></div><p>This works, but has a few disadvantages:</p><ul class="bullet-x"><li>It’s a pain to deal with images with sidelength not a power of 2. It can be done, but I wouldn’t want to do it.<a href="#footnote-2" class="reference"><sup>[2]</sup><span class="anchor" id="reference-2"></span></a></li><li>Each iteration requires a texture of a different size. Instantiating and swapping around all of these textures (or managing <code>glViewport</code>) is a pain.</li><li>Perhaps most importantly, this technique clearly works and is thus mathematically uninteresting.</li></ul><p>An alternative technique that “resolves” some of these issues is to just blur the image repeatedly until it becomes a solid color, then read an arbitrary pixel.</p><div class="image-sequence-container"><span class="arrow desktop" style="display:none">→</span><span class="arrow mobile" style="display:none">↓</span><img src="/static/media/0.44d4b873.png" alt="Blurred 0 times" height="100" width="100"><span class="arrow desktop" style="display:inline-block">→</span><span class="arrow mobile" style="display:inline-block">↓</span><img src="/static/media/1.91ad5ba6.png" alt="Blurred 1 times" height="100" width="100"><span class="arrow desktop" style="display:inline-block">→</span><span class="arrow mobile" style="display:inline-block">↓</span><img src="/static/media/2.800fe9c7.png" alt="Blurred 2 times" height="100" width="100"><span class="arrow desktop" style="display:inline-block">→</span><img src="/static/media/3.9343afc8.png" alt="Blurred 3 times" height="100" width="100" class="desktop"></div><p>This technique:</p><ul class="bullet-check"><li>Works equally well on images of any size or shape.</li><li>Uses textures of all the same size, so we only need to instantiate two textures and render back and forth between them.</li><li>And, as we’re about to see, is <i>very</i> interesting.</li></ul><p>To obtain an accurate average and avoid edge-effects, we treat the texture as a torus. What the blur operation is really doing, then, is circularly convolving the input image with a Gaussian kernel:</p><div class="convolution-diagram"><div class="labelled-image"><img src="/static/media/tux.2710825d.png" alt="Original" height="128" width="128" class="desktop"><img src="/static/media/tux.2710825d.png" alt="Original" height="89.6" width="89.6" class="mobile"><p class="label"><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">I_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07847em">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.301108em"><span class="" style="top:-2.55em;margin-left:-.07847em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span class=""></span></span></span></span></span></span></span></span></span></span></p></div><p class="operator"><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∗</mo></mrow><annotation encoding="application/x-tex">*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.46528em;vertical-align:0"></span><span class="mord">∗</span></span></span></span></span></p><div class="labelled-image"><img src="data:image/png;base64,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" alt="Gaussian Kernel" height="50" width="50" class="desktop"><img src="data:image/png;base64,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" alt="Gaussian Kernel" height="35" width="35" class="mobile"><p class="label"><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.07153em">K</span></span></span></span></span></p></div><p class="operator"><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo></mrow><annotation encoding="application/x-tex">=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.36687em;vertical-align:0"></span><span class="mrel">=</span></span></span></span></span></p><div class="labelled-image"><img src="/static/media/1.91ad5ba6.png" alt="Blurred Once" height="128" width="128" class="desktop"><img src="/static/media/1.91ad5ba6.png" alt="Blurred Once" height="89.6" width="89.6" class="mobile"><p class="label"><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mn>1</mn></msub><mo>=</mo><msub><mi>I</mi><mn>0</mn></msub><mo>∗</mo><mi>K</mi></mrow><annotation encoding="application/x-tex">I_1 = I_0 * K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07847em">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.301108em"><span class="" style="top:-2.55em;margin-left:-.07847em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right:.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.277778em"></span></span><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07847em">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.301108em"><span class="" style="top:-2.55em;margin-left:-.07847em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right:.222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.222222em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.07153em">K</span></span></span></span></span></p></div></div><p>As you may have guessed from the above images, however, repeated Gaussian blurring is <i>really bad</i> for this purpose. The issue is that the Gaussian kernel is very local, so information doesn’t spread very fast throughout the image.</p><h2>How to Judge a Kernel</h2><p>Perhaps a kernel that’s more spread out would do better — indeed, there’s no reason for the kernel to even be contiguous!</p><p>But first, we need a way to quantify the “quality” of a kernel <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.07153em">K</span></span></span></span></span>. Let <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">I_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07847em">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.301108em"><span class="" style="top:-2.55em;margin-left:-.07847em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span class=""></span></span></span></span></span></span></span></span></span></span> denote the original image, and let <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">I_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07847em">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span class="" style="top:-2.55em;margin-left:-.07847em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span class=""></span></span></span></span></span></span></span></span></span></span> denote the image after convolving with <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.07153em">K</span></span></span></span></span> a total of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">n</span></span></span></span></span> times. Then <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>n</mi></msub><mo>=</mo><msub><mi>I</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>∗</mo><mi>K</mi></mrow><annotation encoding="application/x-tex">I_n = I_{n-1} * K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07847em">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span class="" style="top:-2.55em;margin-left:-.07847em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right:.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.277778em"></span></span><span class="base"><span class="strut" style="height:.891661em;vertical-align:-.208331em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07847em">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.301108em"><span class="" style="top:-2.55em;margin-left:-.07847em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.208331em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right:.222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.222222em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.07153em">K</span></span></span></span></span>, and taking the 2D discrete Fourier transform yields <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>I</mi><mo>^</mo></mover><mi>n</mi></msub><mo>=</mo><msub><mover accent="true"><mi>I</mi><mo>^</mo></mover><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>⋅</mo><mover accent="true"><mi>K</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{I}_n = \hat{I}_{n-1} \cdot \hat{K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.09677em;vertical-align:-.15em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.94677em"><span class="" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07847em">I</span></span></span><span class="" style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span class="" style="top:-2.55em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right:.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.277778em"></span></span><span class="base"><span class="strut" style="height:1.1551em;vertical-align:-.208331em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.94677em"><span class="" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07847em">I</span></span></span><span class="" style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.301108em"><span class="" style="top:-2.55em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.208331em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right:.222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.222222em"></span></span><span class="base"><span class="strut" style="height:.94677em;vertical-align:0"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.94677em"><span class="" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07153em">K</span></span></span><span class="" style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.19444em"><span class="mord">^</span></span></span></span></span></span></span></span></span></span></span>.<a href="#footnote-3" class="reference"><sup>[3]</sup><span class="anchor" id="reference-3"></span></a>From here, we easily obtain <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>I</mi><mo>^</mo></mover><mi>n</mi></msub><mo>=</mo><msub><mover accent="true"><mi>I</mi><mo>^</mo></mover><mn>0</mn></msub><mo>⋅</mo><msup><mover accent="true"><mi>K</mi><mo>^</mo></mover><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">\hat{I}_n = \hat{I}_0 \cdot \hat{K}^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.09677em;vertical-align:-.15em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.94677em"><span class="" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07847em">I</span></span></span><span class="" style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span class="" style="top:-2.55em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right:.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.277778em"></span></span><span class="base"><span class="strut" style="height:1.09677em;vertical-align:-.15em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.94677em"><span class="" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07847em">I</span></span></span><span class="" style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.301108em"><span class="" style="top:-2.55em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right:.222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.222222em"></span></span><span class="base"><span class="strut" style="height:.94677em;vertical-align:0"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.94677em"><span class="" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07153em">K</span></span></span><span class="" style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.19444em"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.664392em"><span class="" style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span>.</p><p>The image <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi mathvariant="normal">∞</mi></msub></mrow><annotation encoding="application/x-tex">I_\infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07847em">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span class="" style="top:-2.55em;margin-left:-.07847em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">∞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span class=""></span></span></span></span></span></span></span></span></span></span> we want to eventually converge to has all pixels equal to the average value <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⟨</mo><msub><mi>I</mi><mn>0</mn></msub><mo stretchy="false">⟩</mo></mrow><annotation encoding="application/x-tex">\langle I_0 \rangle</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">⟨</span><span class="mord"><span class="mord mathnormal" style="margin-right:.07847em">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.301108em"><span class="" style="top:-2.55em;margin-left:-.07847em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span class=""></span></span></span></span></span></span><span class="mclose">⟩</span></span></span></span></span> of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">I_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07847em">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.301108em"><span class="" style="top:-2.55em;margin-left:-.07847em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span class=""></span></span></span></span></span></span></span></span></span></span>, so that <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>I</mi><mo>^</mo></mover><mi mathvariant="normal">∞</mi></msub><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo><mo>=</mo><msub><mover accent="true"><mi>I</mi><mo>^</mo></mover><mn>0</mn></msub><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\hat{I}_\infty(0, 0) = \hat{I}_0(0, 0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.19677em;vertical-align:-.25em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.94677em"><span class="" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07847em">I</span></span></span><span class="" style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span class="" style="top:-2.55em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">∞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.166667em"></span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.277778em"></span></span><span class="base"><span class="strut" style="height:1.19677em;vertical-align:-.25em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.94677em"><span class="" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07847em">I</span></span></span><span class="" style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.301108em"><span class="" style="top:-2.55em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.166667em"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span></span> is the only non-zero coefficient in <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>I</mi><mo>^</mo></mover><mi mathvariant="normal">∞</mi></msub></mrow><annotation encoding="application/x-tex">\hat{I}_\infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.09677em;vertical-align:-.15em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.94677em"><span class="" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07847em">I</span></span></span><span class="" style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span class="" style="top:-2.55em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">∞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span class=""></span></span></span></span></span></span></span></span></span></span>. Intuitively, the “quality” of the kernel <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.07153em">K</span></span></span></span></span> should quantify how quickly the <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>n</mi></msub><mo>→</mo><msub><mi>I</mi><mi mathvariant="normal">∞</mi></msub></mrow><annotation encoding="application/x-tex">I_n \to I_\infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07847em">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span class="" style="top:-2.55em;margin-left:-.07847em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right:.277778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right:.277778em"></span></span><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07847em">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span class="" style="top:-2.55em;margin-left:-.07847em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">∞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span class=""></span></span></span></span></span></span></span></span></span></span>, say in <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="normal">ℓ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\ell^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.814108em;vertical-align:0"></span><span class="mord"><span class="mord">ℓ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.814108em"><span class="" style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span> norm. By Parseval’s theorem, it is equivalent to study the convergence of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>I</mi><mo>^</mo></mover><mi>n</mi></msub><mo>→</mo><msub><mover accent="true"><mi>I</mi><mo>^</mo></mover><mi mathvariant="normal">∞</mi></msub></mrow><annotation encoding="application/x-tex">\hat{I}_n \to \hat{I}_\infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.09677em;vertical-align:-.15em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.94677em"><span class="" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07847em">I</span></span></span><span class="" style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span class="" style="top:-2.55em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right:.277778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right:.277778em"></span></span><span class="base"><span class="strut" style="height:1.09677em;vertical-align:-.15em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.94677em"><span class="" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07847em">I</span></span></span><span class="" style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span class="" style="top:-2.55em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">∞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span class=""></span></span></span></span></span></span></span></span></span></span> in <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="normal">ℓ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\ell^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.814108em;vertical-align:0"></span><span class="mord"><span class="mord">ℓ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.814108em"><span class="" style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>. To do this, we’ll first need to deduce a bit more about <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>K</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.94677em;vertical-align:0"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.94677em"><span class="" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07153em">K</span></span></span><span class="" style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.19444em"><span class="mord">^</span></span></span></span></span></span></span></span></span></span></span>.</p><p>Let <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>e</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">e_{i, j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.716668em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span class="" style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span class=""></span></span></span></span></span></span></span></span></span></span> for <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>≤</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">0 \leq i, j \leq N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.78041em;vertical-align:-.13597em"></span><span class="mord">0</span><span class="mspace" style="margin-right:.277778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:.277778em"></span></span><span class="base"><span class="strut" style="height:.85396em;vertical-align:-.19444em"></span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.166667em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mspace" style="margin-right:.277778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:.277778em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span></span></span></span></span> denote the image with value 1 at pixel <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i, j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.166667em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mclose">)</span></span></span></span></span> and 0 elsewhere. Then every coefficient in <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>e</mi><mo>^</mo></mover><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\hat{e}_{i, j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.980548em;vertical-align:-.286108em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.69444em"><span class="" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal">e</span></span></span><span class="" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.19444em"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span class="" style="top:-2.55em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span class=""></span></span></span></span></span></span></span></span></span></span> has magnitude 1, by definition.<a href="#footnote-4" class="reference"><sup>[4]</sup><span class="anchor" id="reference-4"></span></a>If we assume that the kernel <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.07153em">K</span></span></span></span></span> is a convex linear combination of the <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>e</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">e_{i, j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.716668em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span class="" style="top:-2.55em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span class=""></span></span></span></span></span></span></span></span></span></span>,<a href="#footnote-5" class="reference"><sup>[5]</sup><span class="anchor" id="reference-5"></span></a> then every coefficient in its Fourier transform <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>K</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.94677em;vertical-align:0"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.94677em"><span class="" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07153em">K</span></span></span><span class="" style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.19444em"><span class="mord">^</span></span></span></span></span></span></span></span></span></span></span> is a convex linear combination of norm-1 complex numbers — and thus has norm at most 1. Thus all components of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>I</mi><mo>^</mo></mover><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">\hat{I}_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.09677em;vertical-align:-.15em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.94677em"><span class="" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07847em">I</span></span></span><span class="" style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span class="" style="top:-2.55em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span class=""></span></span></span></span></span></span></span></span></span></span> either decay exponentially to zero or remain fixed as <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>→</mo><mi mathvariant="normal">∞</mi></mrow><annotation encoding="application/x-tex">n \to \infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.277778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right:.277778em"></span></span><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord">∞</span></span></span></span></span>.</p><p>In fact, since all <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>e</mi><mo>^</mo></mover><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\hat{e}_{i, j}(0, 0) = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.03611em;vertical-align:-.286108em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.69444em"><span class="" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal">e</span></span></span><span class="" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.19444em"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span class="" style="top:-2.55em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.166667em"></span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.277778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span></span>, we have <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>K</mi><mo>^</mo></mover><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\hat{K}(0, 0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.19677em;vertical-align:-.25em"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.94677em"><span class="" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07153em">K</span></span></span><span class="" style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.19444em"><span class="mord">^</span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.166667em"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span></span> = 1, and so all <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>I</mi><mo>^</mo></mover><mi>n</mi></msub><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo><mo>=</mo><msub><mover accent="true"><mi>I</mi><mo>^</mo></mover><mi mathvariant="normal">∞</mi></msub><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\hat{I}_n(0, 0) = \hat{I}_\infty(0, 0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.19677em;vertical-align:-.25em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.94677em"><span class="" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07847em">I</span></span></span><span class="" style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span class="" style="top:-2.55em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.166667em"></span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.277778em"></span></span><span class="base"><span class="strut" style="height:1.19677em;vertical-align:-.25em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.94677em"><span class="" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07847em">I</span></span></span><span class="" style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span class="" style="top:-2.55em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">∞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.166667em"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span></span>. Letting <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>K</mi><mo lspace="0em" mathvariant="normal" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">K'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.751892em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07153em">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span class="" style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span> denote the kernel <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.07153em">K</span></span></span></span></span> with the entry <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(0, 0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.166667em"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span></span> set to zero, we finally define the <i>quality</i> of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.07153em">K</span></span></span></span></span> to be</p><p class="emphasis"><span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>Q</mi><mo stretchy="false">(</mo><mi>K</mi><mo stretchy="false">)</mo><mo>:</mo><mo>=</mo><mfrac><mn>1</mn><mrow><msup><mi mathvariant="normal">ℓ</mi><mi mathvariant="normal">∞</mi></msup><mo stretchy="false">(</mo><mover accent="true"><msup><mi>K</mi><mo lspace="0em" mathvariant="normal" rspace="0em">′</mo></msup><mo>^</mo></mover><mo stretchy="false">)</mo></mrow></mfrac><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">Q(K) \defeq \frac{1}{\ell^\infty(\hat{K'})}.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.07153em">K</span><span class="mclose">)</span><span class="mspace" style="margin-right:.277778em"></span><span class="mrel">:</span></span><span class="base"><span class="strut" style="height:.36687em;vertical-align:0"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.277778em"></span></span><span class="base"><span class="strut" style="height:2.40821em;vertical-align:-1.08677em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span class="" style="top:-2.16323em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord">ℓ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.590392em"><span class="" style="top:-2.989em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">∞</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.94677em"><span class="" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:.07153em">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.677892em"><span class="" style="top:-2.989em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.25em"><span class="mord">^</span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span class="" style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.08677em"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">.</span></span></span></span></span></span></p><p>Put simply, we look at the largest coefficient in <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>K</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.94677em;vertical-align:0"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.94677em"><span class="" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07153em">K</span></span></span><span class="" style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.19444em"><span class="mord">^</span></span></span></span></span></span></span></span></span></span></span> by magnitude, excluding <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>K</mi><mo>^</mo></mover><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\hat{K}(0, 0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.19677em;vertical-align:-.25em"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.94677em"><span class="" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07153em">K</span></span></span><span class="" style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.19444em"><span class="mord">^</span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.166667em"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span></span>. Then the rate of convergence of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>I</mi><mo>^</mo></mover><mi>n</mi></msub><mo>→</mo><msub><mover accent="true"><mi>I</mi><mo>^</mo></mover><mi mathvariant="normal">∞</mi></msub></mrow><annotation encoding="application/x-tex">\hat{I}_n \to \hat{I}_\infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.09677em;vertical-align:-.15em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.94677em"><span class="" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07847em">I</span></span></span><span class="" style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span class="" style="top:-2.55em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right:.277778em"></span><span class="mrel">→</span><span class="mspace" style="margin-right:.277778em"></span></span><span class="base"><span class="strut" style="height:1.09677em;vertical-align:-.15em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.94677em"><span class="" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07847em">I</span></span></span><span class="" style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.13889em"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span class="" style="top:-2.55em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">∞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span class=""></span></span></span></span></span></span></span></span></span></span> is on the order of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mo stretchy="false">(</mo><mi>K</mi><msup><mo stretchy="false">)</mo><mrow><mo>−</mo><mi>n</mi></mrow></msup></mrow><annotation encoding="application/x-tex">Q(K)^{-n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.02133em;vertical-align:-.25em"></span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.07153em">K</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.771331em"><span class="" style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span></span>: our average becomes roughly <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mo stretchy="false">(</mo><mi>K</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Q(K)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.07153em">K</span><span class="mclose">)</span></span></span></span></span> times better on each iteration.</p><p><i>Sidenote:</i> We can now understand precisely why the Gaussian kernel is so bad: the magnitude of the Fourier transform of a Gaussian is a Gaussian, which has a very “flat” peak near <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(0, 0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.166667em"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span></span>. Thus the Fourier coefficients near <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(0, 0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.166667em"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span></span> have magnitudes almost exactly equal to 1.</p><h2>The Search Begins</h2><p>We now have a clearly defined task: find a kernel <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.07153em">K</span></span></span></span></span> of maximal quality <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mo stretchy="false">(</mo><mi>K</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Q(K)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.07153em">K</span><span class="mclose">)</span></span></span></span></span>.</p><p>Clearly, the optimal quality is <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∞</mi></mrow><annotation encoding="application/x-tex">\infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord">∞</span></span></span></span></span>, when all coefficients of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>K</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.94677em;vertical-align:0"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.94677em"><span class="" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07153em">K</span></span></span><span class="" style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.19444em"><span class="mord">^</span></span></span></span></span></span></span></span></span></span></span> other than <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>K</mi><mo>^</mo></mover><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\hat{K}(0, 0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.19677em;vertical-align:-.25em"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.94677em"><span class="" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07153em">K</span></span></span><span class="" style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.19444em"><span class="mord">^</span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.166667em"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span></span> are zero. This corresponds to a filter with equal weight on every pixel of the image, so we converge in one step. End of post!</p><p>Of course, in practice this would be horrendously slow, even on the GPU. The performance of our fragment shader is related to the number of input pixels we access per output pixel — i.e., the number of non-zero entries of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.07153em">K</span></span></span></span></span>. So, our task is really:</p><p class="emphasis">Find a kernel <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.07153em">K</span></span></span></span></span> of maximal quality <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mo stretchy="false">(</mo><mi>K</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Q(K)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.07153em">K</span><span class="mclose">)</span></span></span></span></span>, subject to <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="normal">ℓ</mi><mn>0</mn></msup><mo stretchy="false">(</mo><mi>K</mi><mo stretchy="false">)</mo><mo>≤</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">\ell^0(K) \leq N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.06411em;vertical-align:-.25em"></span><span class="mord"><span class="mord">ℓ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.814108em"><span class="" style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.07153em">K</span><span class="mclose">)</span><span class="mspace" style="margin-right:.277778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:.277778em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span></span></span></span></span>.</p><p>There’s just one issue: this task is <i>horrendously</i> difficult.<a href="#footnote-6" class="reference"><sup>[6]</sup><span class="anchor" id="reference-6"></span></a></p><p>This forces us to turn to brute-force Monte-Carlo methods. The procedure I used is as follows:</p><ol><li>Randomly choose <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span></span></span></span></span> pixels without replacement from the <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.222222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.222222em"></span></span><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">n</span></span></span></span></span> input image. These locations represent precisely the non-zero entries of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.07153em">K</span></span></span></span></span>.</li><li>Given this restriction, maximize <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mo stretchy="false">(</mo><mi>K</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Q(K)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.07153em">K</span><span class="mclose">)</span></span></span></span></span> using the method of your choice. This is an <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span></span></span></span></span>-dimensional optimization problem where the variables must be non-negative and sum to one.<a href="#footnote-7" class="reference"><sup>[7]</sup><span class="anchor" id="reference-7"></span></a> I used <code>scipy.optimize</code>.</li><li>Repeat.</li></ol><p>Keeping track of the maximum-quality kernel during this procedure should give a good estimate of the true solution. Here’s some experimental results for a square image of sidelength <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>128</mn></mrow><annotation encoding="application/x-tex">n =128</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.277778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mord">2</span><span class="mord">8</span></span></span></span></span>:</p><img src="/static/media/128.147128ba.svg" alt="Experimental results" class="desktop"><img src="/static/media/128-mobile.3d0fa057.svg" alt="Experimental results" class="mobile"><p>As expected, the quality increases as the sparsity budget <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span></span></span></span></span> is increased. For a given <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span></span></span></span></span>, the median kernel quality, in the grand scheme of things, isn’t <i>that</i> much worse than that of the best observed candidate.</p><p>So perhaps we don’t need to find the absolute <i>best</i> kernel for a given sparsity; using randomly chosen pixel locations yields comparable quality, and we can just increase <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span></span></span></span></span> by a bit if it’s not good enough.</p><h2>Theoretical Insight</h2><p>How can we understand this result theoretically? The optimization step (Step 2) is quite difficult to think about, so let’s assume that all <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span></span></span></span></span> randomly chosen pixels end up with equal weights.<a href="#footnote-8" class="reference"><sup>[8]</sup><span class="anchor" id="reference-8"></span></a></p><p>Consider an arbitrary coefficient <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>K</mi><mo>^</mo></mover><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\hat{K}(u, v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.19677em;vertical-align:-.25em"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.94677em"><span class="" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07153em">K</span></span></span><span class="" style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.19444em"><span class="mord">^</span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.166667em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mclose">)</span></span></span></span></span>, excluding <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(u, v) = (0, 0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.166667em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.277778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.166667em"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span></span>. This coefficient will be the average of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>e</mi><mo>^</mo></mover><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\hat{e}_{i, j}(u, v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.03611em;vertical-align:-.286108em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.69444em"><span class="" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal">e</span></span></span><span class="" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.19444em"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span class="" style="top:-2.55em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.166667em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mclose">)</span></span></span></span></span> for <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span></span></span></span></span> randomly chosen pairs <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i, j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.166667em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mclose">)</span></span></span></span></span>. Since <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>e</mi><mo>^</mo></mover><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\hat{e}_{i, j}(u, v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.03611em;vertical-align:-.286108em"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.69444em"><span class="" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal">e</span></span></span><span class="" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.19444em"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.311664em"><span class="" style="top:-2.55em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.166667em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mclose">)</span></span></span></span></span> has unit norm and essentially random phase, its real part has a mean of zero and a variance of<span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mn>1</mn><mrow><mn>2</mn><mi>π</mi></mrow></mfrac><msubsup><mo>∫</mo><mn>0</mn><mrow><mn>2</mn><mi>π</mi></mrow></msubsup><msup><mo><mi>cos</mi><mo>⁡</mo></mo><mn>2</mn></msup><mi>θ</mi> <mrow><mi mathvariant="normal">d</mi><mi>θ</mi></mrow><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\frac{1}{2\pi}\int_0^{2\pi} \cos^2{\theta} \, \dd{\theta} = \frac{1}{2}.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.47596em;vertical-align:-.91195em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span class="" style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span><span class="mord mathnormal" style="margin-right:.03588em">π</span></span></span><span class="" style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span class="" style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.166667em"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:.44445em;position:relative;top:-.001125em">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.56401em"><span class="" style="top:-1.78805em;margin-left:-.44445em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span class="" style="top:-3.8129em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight" style="margin-right:.03588em">π</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.91195em"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right:.166667em"></span><span class="mop"><span class="mop">cos</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.864108em"><span class="" style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.166667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.02778em">θ</span></span><span class="mspace" style="margin-right:.166667em"></span><span class="mord"><span class="mord"><span class="mord mathrm">d</span></span><span class="mord mathnormal" style="margin-right:.02778em">θ</span></span><span class="mspace" style="margin-right:.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.277778em"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em"><span class="" style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span><span class="" style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span class="" style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">.</span></span></span></span></span></span>Assuming the <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i, j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.166667em"></span><span class="mord mathnormal" style="margin-right:.05724em">j</span><span class="mclose">)</span></span></span></span></span> are roughly independent and <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span></span></span></span></span> is relatively large, we have <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">R</mi><mi mathvariant="normal">e</mi></mrow><mo stretchy="false">(</mo><mover accent="true"><mi>K</mi><mo>^</mo></mover><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>∼</mo><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mn>2</mn><mi>N</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathrm{Re}(\hat{K}(u, v)) \sim \mathcal{N}(0, 1/(2N))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.19677em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathrm">R</span><span class="mord mathrm">e</span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.94677em"><span class="" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07153em">K</span></span></span><span class="" style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.19444em"><span class="mord">^</span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.166667em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:.277778em"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:.277778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathcal" style="margin-right:.14736em">N</span></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.166667em"></span><span class="mord">1</span><span class="mord">/</span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:.10903em">N</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span> by the Central Limit Theorem. The same holds for the imaginary component, so <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mover accent="true"><mi>K</mi><mo>^</mo></mover><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">\abss{\hat{K}(u, v)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.19677em;vertical-align:-.25em"></span><span class="mord">∣</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.94677em"><span class="" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07153em">K</span></span></span><span class="" style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.19444em"><span class="mord">^</span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.166667em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mclose">)</span><span class="mord">∣</span></span></span></span></span> has the Rayleigh distribution<span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">∣</mi><mover accent="true"><mi>K</mi><mo>^</mo></mover><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mi mathvariant="normal">∣</mi><mo>∼</mo><mfrac><mi>x</mi><msup><mi>σ</mi><mn>2</mn></msup></mfrac><msup><mi>e</mi><mrow><mo>−</mo><msup><mi>x</mi><mn>2</mn></msup><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mn>2</mn><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow></msup><mo separator="true">,</mo><mspace width="1em"></mspace><mi>x</mi><mo>≥</mo><mn>0</mn><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">\abss{\hat{K}(u, v)} \sim \frac{x}{\sigma^2} e^{-x^2/(2 \sigma^2)}, \quad x \geq 0,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.19677em;vertical-align:-.25em"></span><span class="mord">∣</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.94677em"><span class="" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07153em">K</span></span></span><span class="" style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.19444em"><span class="mord">^</span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.166667em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mclose">)</span><span class="mord">∣</span><span class="mspace" style="margin-right:.277778em"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:.277778em"></span></span><span class="base"><span class="strut" style="height:1.79356em;vertical-align:-.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em"><span class="" style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.740108em"><span class="" style="top:-2.989em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span class="" style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span class="" style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.03692em"><span class="" style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.891314em"><span class="" style="top:-2.931em;margin-right:.0714286em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mtight">/</span><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03588em">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.891314em"><span class="" style="top:-2.931em;margin-right:.0714286em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:.166667em"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.277778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:.277778em"></span></span><span class="base"><span class="strut" style="height:.83888em;vertical-align:-.19444em"></span><span class="mord">0</span><span class="mpunct">,</span></span></span></span></span></span>where <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>σ</mi><mn>2</mn></msup><mo>=</mo><mn>1</mn><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mn>2</mn><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\sigma^2 = 1/(2N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.814108em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.814108em"><span class="" style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.277778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mord">/</span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:.10903em">N</span><span class="mclose">)</span></span></span></span></span>.</p><p>Since the kernel <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.07153em">K</span></span></span></span></span> is real-valued, half of its Fourier coefficients will be redundant, so we may treat <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>:</mo><mo>=</mo><msup><mi mathvariant="normal">ℓ</mi><mi mathvariant="normal">∞</mi></msup><mo stretchy="false">(</mo><msup><mover accent="true"><mi>K</mi><mo>^</mo></mover><mo lspace="0em" mathvariant="normal" rspace="0em">′</mo></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">M \defeq \ell^\infty(\hat{K}')</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.10903em">M</span><span class="mspace" style="margin-right:.277778em"></span><span class="mrel">:</span></span><span class="base"><span class="strut" style="height:.36687em;vertical-align:0"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.277778em"></span></span><span class="base"><span class="strut" style="height:1.19677em;vertical-align:-.25em"></span><span class="mord"><span class="mord">ℓ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.664392em"><span class="" style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">∞</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.94677em"><span class="" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07153em">K</span></span></span><span class="" style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.19444em"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span class="" style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> as the maximum of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>n</mi><mn>2</mn></msup><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">n^2/2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.06411em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.814108em"><span class="" style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord">/</span><span class="mord">2</span></span></span></span></span> independent<a href="#footnote-9" class="reference"><sup>[9]</sup><span class="anchor" id="reference-9"></span></a> Rayleigh-distributed random variables. The CDF of each Rayleigh-distributed variable is <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo>−</mo><msup><mi>e</mi><mrow><mo>−</mo><msup><mi>x</mi><mn>2</mn></msup><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mn>2</mn><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">F(x) = 1-e^{-x^2 / (2 \sigma^2)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.277778em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">1</span><span class="mspace" style="margin-right:.222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.222222em"></span></span><span class="base"><span class="strut" style="height:.98692em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.98692em"><span class="" style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.891314em"><span class="" style="top:-2.931em;margin-right:.0714286em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mtight">/</span><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03588em">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.891314em"><span class="" style="top:-2.931em;margin-right:.0714286em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span>, so the expected value of the maximum is<span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="double-struck">E</mi><mo stretchy="false">(</mo><mi>M</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mo>∫</mo><mn>0</mn><mi mathvariant="normal">∞</mi></msubsup><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>F</mi><mo stretchy="false">(</mo><mi>x</mi><msup><mo stretchy="false">)</mo><mrow><msup><mi>n</mi><mn>2</mn></msup><mi mathvariant="normal">/</mi><mn>2</mn></mrow></msup><mo stretchy="false">)</mo> <mrow><mi mathvariant="normal">d</mi><mi>x</mi></mrow><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\mathbb{E}(M) = \int_0^\infty (1 - F(x)^{n^2/2}) \, \dd{x}.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathbb">E</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.10903em">M</span><span class="mclose">)</span><span class="mspace" style="margin-right:.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.277778em"></span></span><span class="base"><span class="strut" style="height:2.32624em;vertical-align:-.91195em"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:.44445em;position:relative;top:-.001125em">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.41429em"><span class="" style="top:-1.78805em;margin-left:-.44445em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span class="" style="top:-3.8129em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">∞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.91195em"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:.222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.222222em"></span></span><span class="base"><span class="strut" style="height:1.28692em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.03692em"><span class="" style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.891314em"><span class="" style="top:-2.931em;margin-right:.0714286em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mtight">/</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.166667em"></span><span class="mord"><span class="mord"><span class="mord mathrm">d</span></span><span class="mord mathnormal">x</span></span><span class="mord">.</span></span></span></span></span></span>Assuming <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span></span></span></span></span> and <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>n</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">n^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.814108em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.814108em"><span class="" style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span> are both fairly large, the integrand can be well-approximated as a step function that transitions from <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span></span> to <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">0</span></span></span></span></span> at the <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">x</span></span></span></span></span>-value satisfying <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>x</mi><msup><mo stretchy="false">)</mo><mrow><msup><mi>n</mi><mn>2</mn></msup><mi mathvariant="normal">/</mi><mn>2</mn></mrow></msup><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">F(x)^{n^2/2} = \frac{1}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.23692em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.13889em">F</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.98692em"><span class="" style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.891314em"><span class="" style="top:-2.931em;margin-right:.0714286em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mtight">/</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.277778em"></span></span><span class="base"><span class="strut" style="height:1.19011em;vertical-align:-.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.845108em"><span class="" style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span class="" style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span class="" style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>. Solving, we obtain</p><p class="emphasis"><span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable columnalign="right left" columnspacing="0em" rowspacing="0.24999999999999992em"><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mi mathvariant="double-struck">E</mi><mo stretchy="false">(</mo><mi>M</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mo>≈</mo><mi>σ</mi><msqrt><mrow><mo>−</mo><mn>2</mn><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mroot><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mn>2</mn></mrow><mrow><msup><mi>n</mi><mn>2</mn></msup><mi mathvariant="normal">/</mi><mn>2</mn></mrow></mroot><mo stretchy="false">)</mo></mrow></msqrt></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow></mrow><mo>≈</mo><msqrt><mfrac><mrow><mn>2</mn><mi>log</mi><mo>⁡</mo><mi>n</mi><mo>−</mo><mi>log</mi><mo>⁡</mo><mn>2</mn><mo>−</mo><mi>log</mi><mo>⁡</mo><mrow><mi>log</mi><mo>⁡</mo><mn>2</mn></mrow></mrow><mi>N</mi></mfrac></msqrt><mi mathvariant="normal">.</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} \mathbb{E}(M) &\approx \sigma \sqrt{-2 \log(1 - \sqrt[n^2/2]{1/2})} \\ &\approx \sqrt{\frac{2\log{n} - \log{2} - \log{\log{2}}}{N}}. \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.88em;vertical-align:-2.19em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.69em"><span class="" style="top:-4.96884em"><span class="pstrut" style="height:3.67659em"></span><span class="mord"><span class="mord"><span class="mord mathbb">E</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.10903em">M</span><span class="mclose">)</span></span></span><span class="" style="top:-2.55em"><span class="pstrut" style="height:3.67659em"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.19em"><span class=""></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.69em"><span class="" style="top:-4.96884em"><span class="pstrut" style="height:3.67659em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.277778em"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:.277778em"></span><span class="mord mathnormal" style="margin-right:.03588em">σ</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.39775em"><span class="svg-align" style="top:-3.8em"><span class="pstrut" style="height:3.8em"></span><span class="mord" style="padding-left:1em"><span class="mord">−</span><span class="mord">2</span><span class="mspace" style="margin-right:.166667em"></span><span class="mop">lo<span style="margin-right:.01389em">g</span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:.222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.222222em"></span><span class="mord sqrt"><span class="root"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.96087em"><span class="" style="top:-2.96087em"><span class="pstrut" style="height:2.52422em"></span><span class="sizing reset-size6 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.04844em"><span class="" style="top:-3.04844em;margin-right:.1em"><span class="pstrut" style="height:2.64444em"></span><span class="mord mtight">2</span></span></span></span></span></span></span><span class="mord mtight">/</span><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.983875em"><span class="svg-align" style="top:-3.2em"><span class="pstrut" style="height:3.2em"></span><span class="mord" style="padding-left:1em"><span class="mord">1</span><span class="mord">/</span><span class="mord">2</span></span></span><span class="" style="top:-2.94388em"><span class="pstrut" style="height:3.2em"></span><span class="hide-tail" style="min-width:1.02em;height:1.28em"><svg height="1.28em" preserveAspectRatio="xMinYMin slice" viewBox="0 0 400000 1296" width="400em"><path d="M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.256125em"><span class=""></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top:-3.35775em"><span class="pstrut" style="height:3.8em"></span><span class="hide-tail" style="min-width:1.02em;height:1.88em"><svg height="1.8800000000000001em" preserveAspectRatio="xMinYMin slice" viewBox="0 0 400000 1944" width="400em"><path d="M983 90
l0 -0
c4,-6.7,10,-10,18,-10 H400000v40
H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7
s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744
c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30
c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722
c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5
c53.7,-170.3,84.5,-266.8,92.5,-289.5z
M1001 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.44225em"><span class=""></span></span></span></span></span></span></span><span class="" style="top:-2.55em"><span class="pstrut" style="height:3.67659em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.277778em"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:.277778em"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.67659em"><span class="svg-align" style="top:-4.4em"><span class="pstrut" style="height:4.4em"></span><span class="mord" style="padding-left:1em"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em"><span class="" style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.10903em">N</span></span></span><span class="" style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span class="" style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span><span class="mspace" style="margin-right:.166667em"></span><span class="mop">lo<span style="margin-right:.01389em">g</span></span><span class="mspace" style="margin-right:.166667em"></span><span class="mord"><span class="mord mathnormal">n</span></span><span class="mspace" style="margin-right:.222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.222222em"></span><span class="mop">lo<span style="margin-right:.01389em">g</span></span><span class="mspace" style="margin-right:.166667em"></span><span class="mord"><span class="mord">2</span></span><span class="mspace" style="margin-right:.222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.222222em"></span><span class="mop">lo<span style="margin-right:.01389em">g</span></span><span class="mspace" style="margin-right:.166667em"></span><span class="mord"><span class="mop">lo<span style="margin-right:.01389em">g</span></span><span class="mspace" style="margin-right:.166667em"></span><span class="mord"><span class="mord">2</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="" style="top:-3.6366em"><span class="pstrut" style="height:4.4em"></span><span class="hide-tail" style="min-width:1.02em;height:2.48em"><svg height="2.48em" preserveAspectRatio="xMinYMin slice" viewBox="0 0 400000 2592" width="400em"><path d="M424,2478
c-1.3,-0.7,-38.5,-172,-111.5,-514c-73,-342,-109.8,-513.3,-110.5,-514
c0,-2,-10.7,14.3,-32,49c-4.7,7.3,-9.8,15.7,-15.5,25c-5.7,9.3,-9.8,16,-12.5,20
s-5,7,-5,7c-4,-3.3,-8.3,-7.7,-13,-13s-13,-13,-13,-13s76,-122,76,-122s77,-121,77,-121
s209,968,209,968c0,-2,84.7,-361.7,254,-1079c169.3,-717.3,254.7,-1077.7,256,-1081
l0 -0c4,-6.7,10,-10,18,-10 H400000
v40H1014.6
s-87.3,378.7,-272.6,1166c-185.3,787.3,-279.3,1182.3,-282,1185
c-2,6,-10,9,-24,9
c-8,0,-12,-0.7,-12,-2z M1001 80
h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.763405em"><span class=""></span></span></span></span></span><span class="mord">.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.19em"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span></p><p>The median quality <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mo stretchy="false">(</mo><mi>K</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Q(K)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.07153em">K</span><span class="mclose">)</span></span></span></span></span> should be roughly the inverse of this. With fingers crossed, we compare the theory to experiment:</p><img src="/static/media/128-fit.882f3da2.svg" alt="Comparison of theory and experiment" class="desktop"><img src="/static/media/128-fit-mobile.c6913a87.svg" alt="Comparison of theory and experiment" class="mobile"><p>Not bad, but not great. The actual median <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mo stretchy="false">(</mo><mi>K</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Q(K)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.07153em">K</span><span class="mclose">)</span></span></span></span></span> is a bit higher, presumably due to the optimization step (Step 2) that we overlooked. Indeed, if we disable the optimization step and weight each kernel entry equally, the results match quite closely:</p><img src="/static/media/128-raw-fit.5d5376bc.svg" alt="Comparison of theory and experiment, optimization step disabled" class="desktop"><img src="/static/media/128-raw-fit-mobile.7f718fff.svg" alt="Comparison of theory and experiment, optimization step disabled" class="mobile"><p>Thus we can expect our estimate to provide a reliable lower bound for the optimized median. This is actually great news: even randomly choosing pixels and setting equal weights, to achieve a target quality <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.87777em;vertical-align:-.19444em"></span><span class="mord mathnormal">Q</span></span></span></span></span>, we need only choose a filter with a size of</p><p class="emphasis"><span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>N</mi><mo>≈</mo><mn>2</mn><msup><mi>Q</mi><mn>2</mn></msup><mi>log</mi><mo>⁡</mo><mi>n</mi><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">N \approx 2 Q^2 \log{n},</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span><span class="mspace" style="margin-right:.277778em"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:.277778em"></span></span><span class="base"><span class="strut" style="height:1.05855em;vertical-align:-.19444em"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.864108em"><span class="" style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.166667em"></span><span class="mop">lo<span style="margin-right:.01389em">g</span></span><span class="mspace" style="margin-right:.166667em"></span><span class="mord"><span class="mord mathnormal">n</span></span><span class="mpunct">,</span></span></span></span></span></span></p><p>which grows only logarithmically with the image size! Thus, even for fairly large images, the kernel remains sparse enough for near-constant-time evaluation on the GPU.</p><h2>Demo Time!</h2><p>The example image I’ve been using has sidelength <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>256</mn></mrow><annotation encoding="application/x-tex">n = 256</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.277778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">2</span><span class="mord">5</span><span class="mord">6</span></span></span></span></span>. Aiming for a quality of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">Q = 4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.87777em;vertical-align:-.19444em"></span><span class="mord mathnormal">Q</span><span class="mspace" style="margin-right:.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.277778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">4</span></span></span></span></span>, our formula tells us we need to choose a random kernel with <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>178</mn></mrow><annotation encoding="application/x-tex">N = 178</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span><span class="mspace" style="margin-right:.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.277778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mord">7</span><span class="mord">8</span></span></span></span></span> entries. Here’s the results with no kernel optimization (equal weights):<a href="#footnote-11" class="reference"><sup>[11]</sup><span class="anchor" id="reference-11"></span></a></p><div class="image-sequence-container"><span class="arrow desktop" style="display:none">→</span><span class="arrow mobile" style="display:none">↓</span><img src="/static/media/0.44d4b873.png" alt="random kernel, no optimization, applied 0 times" height="100" width="100"><span class="arrow desktop" style="display:inline-block">→</span><span class="arrow mobile" style="display:inline-block">↓</span><img src="/static/media/1.923ff5b0.png" alt="random kernel, no optimization, applied 1 times" height="100" width="100"><span class="arrow desktop" style="display:inline-block">→</span><span class="arrow mobile" style="display:inline-block">↓</span><img src="/static/media/2.e328c156.png" alt="random kernel, no optimization, applied 2 times" height="100" width="100"><span class="arrow desktop" style="display:inline-block">→</span><img src="/static/media/3.5a55f317.png" alt="random kernel, no optimization, applied 3 times" height="100" width="100" class="desktop"></div><p>Here’s the results after optimizing the kernel (Step 2 in the procedure described before):</p><div class="image-sequence-container"><span class="arrow desktop" style="display:none">→</span><span class="arrow mobile" style="display:none">↓</span><img src="/static/media/0.44d4b873.png" alt="random kernel, with optimization, applied 0 times" height="100" width="100"><span class="arrow desktop" style="display:inline-block">→</span><span class="arrow mobile" style="display:inline-block">↓</span><img src="/static/media/1.8355392b.png" alt="random kernel, with optimization, applied 1 times" height="100" width="100"><span class="arrow desktop" style="display:inline-block">→</span><span class="arrow mobile" style="display:inline-block">↓</span><img src="/static/media/2.e8b20584.png" alt="random kernel, with optimization, applied 2 times" height="100" width="100"><span class="arrow desktop" style="display:inline-block">→</span><img src="/static/media/3.e1a2f3a2.png" alt="random kernel, with optimization, applied 3 times" height="100" width="100" class="desktop"></div><p>Yep. Even with the unoptimized kernel, after two iterations the average is resolved to a resolution of at least <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>256</mn><mi mathvariant="normal">/</mi><msup><mi>Q</mi><mn>2</mn></msup><mo>=</mo><mn>16</mn></mrow><annotation encoding="application/x-tex">256 / Q^2 = 16</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.06411em;vertical-align:-.25em"></span><span class="mord">2</span><span class="mord">5</span><span class="mord">6</span><span class="mord">/</span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.814108em"><span class="" style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.277778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mord">6</span></span></span></span></span> in each channel, which is barely perceptible. For comparison, the Gaussian kernel I used at the beginning of the post had <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>101</mn><mo>×</mo><mn>101</mn><mo>=</mo><mn>10</mn><mo separator="true">,</mo><mn>201</mn></mrow><annotation encoding="application/x-tex">101 \times 101 = 10,201</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">1</span><span class="mspace" style="margin-right:.222222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">1</span><span class="mspace" style="margin-right:.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.277778em"></span></span><span class="base"><span class="strut" style="height:.83888em;vertical-align:-.19444em"></span><span class="mord">1</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.166667em"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">1</span></span></span></span></span> entries.<a href="#footnote-10" class="reference"><sup>[10]</sup><span class="anchor" id="reference-10"></span></a></p><p>To achieve the same result with the scaling-based algorithm outlined at the start of the post, you would need to scale down by <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>16</mn><mo>×</mo></mrow><annotation encoding="application/x-tex">16 \times</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">1</span><span class="mord">6</span><span class="mord">×</span></span></span></span></span> at each step, so each output pixel would need to look at <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>256</mn></mrow><annotation encoding="application/x-tex">256</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">2</span><span class="mord">5</span><span class="mord">6</span></span></span></span></span> input pixels. Admittedly, this isn’t a direct comparison, since the scaling method provides an exact solution — but for many applications, a rapidly converging approximate solution does the job.</p><p>And finally, for fun, a demo that calculates the value of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi></mrow><annotation encoding="application/x-tex">\pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.03588em">π</span></span></span></span></span> by averaging an image of a circle! The estimate shown is derived from a <i>single pixel</i> in the displayed image.<a href="#footnote-12" class="reference"><sup>[12]</sup><span class="anchor" id="reference-12"></span></a></p><div class="pi-computer"><p class="estimate"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mo>≈</mo><mn>0.00000...</mn></mrow><annotation encoding="application/x-tex">\pi \approx 0.00000...</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.48312em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.03588em">π</span><span class="mspace" style="margin-right:.277778em"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:.277778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span></span></span></span></p><div class="controls"><button class="MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary" tabindex="0" type="button"><span class="MuiButton-label">Step</span><span class="MuiTouchRipple-root"></span></button><button class="MuiButtonBase-root MuiButton-root MuiButton-outlined" tabindex="0" type="button"><span class="MuiButton-label">Reset</span><span class="MuiTouchRipple-root"></span></button></div><canvas height="300" width="300">Please enable Javascript and WebGL to use the demo.</canvas><div class="kernel-slider"><p class="header">Kernel Sparsity</p><p class="label"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>50</mn></mrow><annotation encoding="application/x-tex">N = 50</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span><span class="mspace" style="margin-right:.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.277778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">5</span><span class="mord">0</span></span></span></span></p><span class="MuiSlider-root MuiSlider-colorPrimary"><span class="MuiSlider-rail"></span><span class="MuiSlider-track" style="left:0;width:48.4536%"></span><input type="hidden" value="50"><span class="MuiSlider-thumb MuiSlider-thumbColorPrimary" style="left:48.4536%" aria-orientation="horizontal" aria-valuemax="100" aria-valuemin="3" aria-valuenow="50" data-index="0" role="slider" tabindex="0"></span></span></div><p class="size">Texture Size: 300 × 300<br>Estimated Quality: Q(K) = 2.094<br></p></div><section class="footnotes"><hr><h2>Footnotes</h2><ol><li><span class="label">[1]</span>Assuming we’re hitting up against the 60 FPS frame cap, this is a reasonable assumption.<a href="#reference-1" class="reference return">↩</a><span class="anchor" id="footnote-1"></span></li><li><span class="label">[2]</span>Incidentally, the <code>glGenerateMipmap</code> function executes essentially this procedure — and is restricted to power-of-two sidelengths only. WebGL 2 supports non-power-of-two textures, but there’s no guarantee the edge effects will be treated as to give an accurate average...<a href="#reference-2" class="reference return">↩</a><span class="anchor" id="footnote-2"></span></li><li><span class="label">[3]</span>Here, we use <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⋅</mo></mrow><annotation encoding="application/x-tex">\cdot</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.44445em;vertical-align:0"></span><span class="mord">⋅</span></span></span></span></span> to denote component-wise multiplication.<a href="#reference-3" class="reference return">↩</a><span class="anchor" id="footnote-3"></span></li><li><span class="label">[4]</span>This also defines the convention we’re using for our Fourier transforms.<a href="#reference-4" class="reference return">↩</a><span class="anchor" id="footnote-4"></span></li><li><span class="label">[5]</span>This is a reasonable assumption — the components should sum to one to preserve the average on each iteration. You can convince yourself (fun exercise!) that negative components will lead to exponential blowups in certain situations.<a href="#reference-5" class="reference return">↩</a><span class="anchor" id="footnote-5"></span></li><li><span class="label">[6]</span>To the best of my knowledge, anyway. If anyone manages to find a reference, I’d <a href="mailto:contact@samuelj.li">love to hear about it</a>!<a href="#reference-6" class="reference return">↩</a><span class="anchor" id="footnote-6"></span></li><li><span class="label">[7]</span>So really, there are <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">N-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.76666em;vertical-align:-.08333em"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span><span class="mspace" style="margin-right:.222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span></span> degrees of freedom.<a href="#reference-7" class="reference return">↩</a><span class="anchor" id="footnote-7"></span></li><li><span class="label">[8]</span>There is some theoretical basis to this assumption — choosing all weights equal minimizes the <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="normal">ℓ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\ell^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.814108em;vertical-align:0"></span><span class="mord"><span class="mord">ℓ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.814108em"><span class="" style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span> norm of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.07153em">K</span></span></span></span></span>, which (by Parseval’s theorem) minimizes the <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="normal">ℓ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\ell^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.814108em;vertical-align:0"></span><span class="mord"><span class="mord">ℓ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.814108em"><span class="" style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span> norm of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mover accent="true"><mi>K</mi><mo>^</mo></mover><mo lspace="0em" mathvariant="normal" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">\hat{K}'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.94677em;vertical-align:0"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.94677em"><span class="" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.07153em">K</span></span></span><span class="" style="top:-3.25233em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.19444em"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span class="" style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span>. The <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="normal">ℓ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\ell^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.814108em;vertical-align:0"></span><span class="mord"><span class="mord">ℓ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.814108em"><span class="" style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span> norm is an upper bound for the <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="normal">ℓ</mi><mi mathvariant="normal">∞</mi></msup></mrow><annotation encoding="application/x-tex">\ell^\infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord"><span class="mord">ℓ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.664392em"><span class="" style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">∞</span></span></span></span></span></span></span></span></span></span></span></span> norm we really care about.<a href="#reference-8" class="reference return">↩</a><span class="anchor" id="footnote-8"></span></li><li><span class="label">[9]</span>As with many of the assumptions here, this isn’t strictly true, but works well enough.<a href="#reference-9" class="reference return">↩</a><span class="anchor" id="footnote-9"></span></li><li><span class="label">[10]</span>Since the Gaussian kernel can be factored, this really only needs 2 passes, one horizontal and one vertical, with a kernel of size 101. But even then, the results with the Gaussian are objectively much worse.<a href="#reference-10" class="reference return">↩</a><span class="anchor" id="footnote-10"></span></li><li><span class="label">[11]</span>For fun, you can try to figure out what kernel I used by downloading the first two images, dividing their 2D discrete Fourier transforms, and taking an inverse DFT. I haven't tried this and have no idea if it will work (since the pixel colors are quantized).<a href="#reference-11" class="reference return">↩</a><span class="anchor" id="footnote-11"></span></li><li><span class="label">[12]</span>Through some clever WebGL hacks, I am using all four color channels internally to increase the precision. There also appears to be a bug on mobile (possibly due to low precision?) that causes a small bit of drift in the final average.<a href="#reference-12" class="reference return">↩</a><span class="anchor" id="footnote-12"></span></li></ol></section></div></div></div></div><script>!function(i){function e(e){for(var t,r,n=e[0],o=e[1],a=e[2],u=0,c=[];u<n.length;u++)r=n[u],Object.prototype.hasOwnProperty.call(d,r)&&d[r]&&c.push(d[r][0]),d[r]=0;for(t in o)Object.prototype.hasOwnProperty.call(o,t)&&(i[t]=o[t]);for(h&&h(e);c.length;)c.shift()();return s.push.apply(s,a||[]),l()}function l(){for(var e,t=0;t<s.length;t++){for(var r=s[t],n=!0,o=1;o<r.length;o++){var a=r[o];0!==d[a]&&(n=!1)}n&&(s.splice(t--,1),e=p(p.s=r[0]))}return e}var r={},f={1:0},d={1:0},s=[];function p(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return i[e].call(t.exports,t,t.exports,p),t.l=!0,t.exports}p.e=function(s){var e=[];f[s]?e.push(f[s]):0!==f[s]&&{3:1,4:1,5:1,6:1,7:1}[s]&&e.push(f[s]=new Promise(function(e,n){for(var t="static/css/"+({}[s]||s)+"."+{3:"8e1d9cdb",4:"dbcb50aa",5:"dbcb50aa",6:"dbcb50aa",7:"d81dec3b",8:"31d6cfe0"}[s]+".chunk.css",o=p.p+t,r=document.getElementsByTagName("link"),a=0;a<r.length;a++){var u=(i=r[a]).getAttribute("data-href")||i.getAttribute("href");if("stylesheet"===i.rel&&(u===t||u===o))return e()}var c=document.getElementsByTagName("style");for(a=0;a<c.length;a++){var i;if((u=(i=c[a]).getAttribute("data-href"))===t||u===o)return e()}var l=document.createElement("link");l.rel="stylesheet",l.type="text/css",l.onload=e,l.onerror=function(e){var t=e&&e.target&&e.target.src||o,r=new Error("Loading CSS chunk "+s+" failed.\n("+t+")");r.request=t,delete f[s],l.parentNode.removeChild(l),n(r)},l.href=o,document.getElementsByTagName("head")[0].appendChild(l)}).then(function(){f[s]=0}));var r=d[s];if(0!==r)if(r)e.push(r[2]);else{var t=new Promise(function(e,t){r=d[s]=[e,t]});e.push(r[2]=t);var n,o=document.createElement("script");o.charset="utf-8",o.timeout=120,p.nc&&o.setAttribute("nonce",p.nc),o.src=p.p+"static/js/"+({}[s]||s)+"."+{3:"dc6fab74",4:"41c4b2a9",5:"cd5b4c54",6:"2b2af048",7:"14c09ab8",8:"a519e305"}[s]+".chunk.js";var a=new Error;n=function(e){o.onerror=o.onload=null,clearTimeout(u);var t=d[s];if(0!==t){if(t){var r=e&&("load"===e.type?"missing":e.type),n=e&&e.target&&e.target.src;a.message="Loading chunk "+s+" failed.\n("+r+": "+n+")",a.name="ChunkLoadError",a.type=r,a.request=n,t[1](a)}d[s]=void 0}};var u=setTimeout(function(){n({type:"timeout",target:o})},12e4);o.onerror=o.onload=n,document.head.appendChild(o)}return Promise.all(e)},p.m=i,p.c=r,p.d=function(e,t,r){p.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},p.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},p.t=function(t,e){if(1&e&&(t=p(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(p.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)p.d(r,n,function(e){return t[e]}.bind(null,n));return r},p.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return p.d(t,"a",t),t},p.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},p.p="/",p.oe=function(e){throw console.error(e),e};var t=window.webpackJsonp=window.webpackJsonp||[],n=t.push.bind(t);t.push=e,t=t.slice();for(var o=0;o<t.length;o++)e(t[o]);var h=n;l()}([])</script><script src="/static/js/2.6301e77b.chunk.js"></script><script src="/static/js/main.b532e1a9.chunk.js"></script></body></html>